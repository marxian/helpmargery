<% layout('widget_layout') -%>

<div id="widget">

	<!-- About -->
	<div class="goto about">
		<div class="top">
			<h1><%= space.name %></h1>
		</div>
		<div class="vcenter">
			<div class="pictures">
				<% if (space.image && typeof space.image === 'object' && space.image.buffer && space.image.mimetype) { %>
					<img width="370" height="370" src="data:<%= space.image.mimetype %>;base64,<%= space.image.buffer.toString('base64') -%>" alt="venue photo">
				<% } %>
			</div>

			<div class="buttons">
				<button data-goto="description">Description</button>
				<button data-goto="availability" class="availability">Check Availability</button>
			</div>
		</div>
	</div>

	<!-- Description -->
	<div class="goto description hide">
		<div class="top">
			<button data-goto="about">&lt;</button>
			<h1>Description</h1>
		</div>
		<div class="vcenter" style="padding: 10px;">
			<p class="description"><%- space.description -%></p>

			<ul class="facilities">
				<li>Changing Rooms</li>
				<li>Wifi</li>
				<li>Free Parking</li>
			</ul>
		</div>
	</div>

	<!-- Availability -->
	<div class="goto availability hide">
		<div class="top">
			<button data-goto="about">&lt;</button>
			<h1>Availability</h1>
		</div>
		<div class="vcenter">
			<% include availability/filters %>
			<% include availability/calendar %>
		</div>
	</div>

	<!-- Book -->
	<div class="goto book hide">
		<div class="top">
			<button data-goto="availability">&lt;</button>
			<h1>Book</h1>
		</div>
		<div class="vcenter">
			<form method="POST" action="<%= space._id %>/book">
				<input type="hidden" name="start" value="" />
				<input type="hidden" name="end" value="" />

				<label for="owner[name]">Your name</label>
				<input required="required" name="owner[name]" value="Alison" />

				<label for="owner[email]">Your email</label>
				<input required="required" name="owner[email]" value="Alison@danceclassesrus.com" />

				<input type="hidden" name="booker[name]" value="booked with widget" />

				<div>
					<button type="submit">Create booking</button>
				</div>
			</form>
		</div>
	</div>

	<div class="footer">
		Square space thing
		<!-- <img src="logo.png" /> -->
	</div>

</div>

<script type="text/javascript">
	window.space = <%- JSON.stringify(space) -%>;
</script>

<script type="text/javascript" src="/javascripts/widget.js"></script>
