<% layout('widget_layout') -%>

<div id="widget">

	<!-- About -->
	<div class="goto about">
		<div class="top">
			<h1><%= space.name %></h1>
		</div>
		<div class="vcenter">
			<div class="pictures">
				<% if (space.image && typeof space.image === 'object' && space.image.buffer && space.image.mimetype) { %>
					<img width="370" height="370" src="data:<%= space.image.mimetype %>;base64,<%= space.image.buffer.toString('base64') -%>" alt="venue photo">
				<% } %>
			</div>
			<% if (space.hire_charge && space.hiring_granularity)  { %>
			<p class="hire_charge">
			Â£<%= space.hire_charge %> <%= space.hiring_granularity %>
			</p>
			<% } %>
			<div class="buttons">
				<button data-goto="description">Description</button>
				<button data-goto="availability" class="availability">Check Availability</button>
			</div>
		</div>
	</div>

	<!-- Description -->
	<div class="goto description hide">
		<div class="top">
			<button data-goto="about">&lt;</button>
			<h1>Description</h1>
		</div>
		<div class="vcenter" style="padding: 10px;">
			<p class="description"><%= space.description %></p>

			<% if (space.hiring_model === 'deposit') { %>
				<p><strong>Deposit required</strong>
			<% } %>
			<% if (space.facilities.length) { %>
			<h4>Facilities</h4>
			<ul class="facilities">
				<% _.each(space.facilities, function(f) { %>
					<li><%= f %></li>
				<% }) %>
			</ul>
			<% } %>

			<% if ( space.address1 || space.address2 || space.town || space.county || space.postcode) { %>
				<h4>Address</h4>
				<% if (space.address1) { %>
					<%= space.address1 %><br/>
				<% } %>
				<% if (space.address2) { %>
					<%= space.address2 %><br/>
				<% } %>
				<% if (space.town) { %>
					<%= space.town %><br/>
				<% } %>
				<% if (space.county) { %>
					<%= space.county %><br/>
				<% } %>
				<% if (space.postcode) { %>
					<%= space.postcode %><br/>
				<% } %>
			<% } %>
		</div>
	</div>

	<!-- Availability -->
	<div class="goto availability hide">
		<div class="top">
			<button data-goto="about">&lt;</button>
			<h1>Availability</h1>
		</div>
		<div class="vcenter">
			<% include availability/filters %>
			<% include availability/calendar %>
		</div>
	</div>

	<!-- Book -->
	<div class="goto book hide">
		<div class="top">
			<button data-goto="availability">&lt;</button>
			<h1>Book</h1>
		</div>
		<div class="vcenter">
			<form method="POST" action="<%= space._id %>/book">
				<label for="start">From:</label>
				<input name="start" value="2015-12-20T00:00:00.025Z" />

				<label for="end">To</label>
				<input name="end" value="2015-11-20T16:01:10.025Z" />

				<label for="owner[name]">Owner name</label>
				<input name="owner[name]" value="Alison" />

				<label for="owner[email]">Owner email</label>
				<input name="owner[email]" value="Alison@danceclassesrus.com" />

				<label for="booker[name]">Booker</label>
				<input name="booker[name]" value="Dance classes r us" />

				<div>
					<button type="submit">Create booking</button>
				</div>
			</form>
		</div>
	</div>

	<% if (!unbranded) { %>
	<div class="footer">
		Square space thing
		<!-- <img src="logo.png" /> -->
	</div>
	<% } %>

</div>

<h2>Bookings</h2>
<code><%= JSON.stringify(space.bookings) %></code>

<script type="text/javascript">
	window.space = <%- JSON.stringify(space) -%>;
</script>

<script type="text/javascript" src="/javascripts/widget.js"></script>
